(()=>{var t,e={9735:function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Base=void 0;var r=n(6911),s=n(3200),a=n(774),c=n(691),u=n(5048),h=n(7918),l=!1,p=!1,d=function(){function t(t,e,n){this.canvas=t,this.domCanvas=e,this.domBundle=n,this.sizer=new a.Sizer(this.canvas),this.scene=new c.Scene,this.scene2=new c.Scene,this.ticker=new a.Ticker,this.camera=new s.Camera(this),this.renderer=new r.Renderer(this),this.playground=new h.Playground(this),this.touched=!1,this.touchedReactDelay=2e3,this.initResizeMechanic(),this.initTickMechanic(),this.initTouchMechanic()}return t.prototype.initResizeMechanic=function(){var t=this;this.sizer.on("resize",(function(){t.renderer.resize(),t.camera.resize()}))},t.prototype.initTickMechanic=function(){var t=this;this.ticker.on("tick",(function(e){var n=e.getDelta();t.renderer.update(),t.camera.update(),t.playground.update(n)}))},t.prototype.initTouchMechanic=function(){var t,e=this,n=new c.Vector2,i=new c.Vector2,o=function(t){n.x=t.clientX,n.y=t.clientY,e.touched=!0},r=function(o){i.x=o.clientX,i.y=o.clientY;var r=n.distanceTo(i)>5?e.touchedReactDelay:0;clearTimeout(t),t=setTimeout((function(){e.touched=!1}),r)};this.domCanvas.addEventListener("mousedown",o),this.domCanvas.addEventListener("touchstart",o),this.domCanvas.addEventListener("mouseup",r),this.domCanvas.addEventListener("touchend",r),this.domCanvas.addEventListener("mouseleave",r)},t.prototype.setRotationLock=function(t){l=t},t.prototype.getRotationLockStatus=function(){return l},t.prototype.setLoginStatus=function(t){p=t},t.prototype.getLoginStatus=function(){return p},t.prototype.getResources=function(){return i(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return t=this,[4,(0,u.getResources)()];case 1:return t.resources=e.sent(),[2]}}))}))},t}();e.Base=d},3200:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Camera=void 0;var i=n(691),o=n(2886),r=function(){function t(t){this.base=t,this.bestPoint=new i.Vector3(-8,1,8),this.minimunDrawbackAngle=Math.PI/3,this.sizer=this.base.sizer,this.canvas=this.base.domCanvas,this.scene=this.base.scene,this.setInstance(),this.setControls()}return t.prototype.setInstance=function(){var t=new i.PerspectiveCamera(35,this.sizer.width/this.sizer.height,.1,100);t.position.set(this.bestPoint.x,this.bestPoint.y,this.bestPoint.z),this.instance=t,this.scene.add(this.instance)},t.prototype.setControls=function(){this.controls=new o.OrbitControls(this.instance,this.canvas),this.controls.enableDamping=!0,this.controls.enableZoom=!1,this.controls.enablePan=!1},t.prototype.resize=function(){this.instance.aspect=this.sizer.width/this.sizer.height,this.instance.updateProjectionMatrix()},t.prototype.update=function(){this.controls.update()},t}();e.Camera=r},5755:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Env=void 0;var i=n(691),o=function(){function t(t){this.base=t,this.setLights()}return t.prototype.setLights=function(){this.setAmbientLight(),this.setDirectionalLight(),this.setBackground()},t.prototype.setDirectionalLight=function(){this.directionalLight=new i.DirectionalLight(16777215,1),this.directionalLight.castShadow=!0,this.directionalLight.shadow.mapSize.set(2048,2048),this.directionalLight.shadow.normalBias=.05,this.directionalLight.position.set(3.5,2,-1.25),this.base.scene.add(this.directionalLight)},t.prototype.setAmbientLight=function(){this.ambientLight=new i.AmbientLight(16777215,1),this.base.scene.add(this.ambientLight)},t.prototype.setBackground=function(){this.base.scene.background=this.base.resources.gradientCubeTexture},t.prototype.update=function(t){},t}();e.Env=o},7918:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Playground=void 0;var r=n(5755),s=n(392),a=n(4868),c=function(t){function e(e){var n=t.call(this)||this;return n.base=e,n.ready=!1,n.initTimeoutDuration=1e3,n.init(),n}return o(e,t),e.prototype.init=function(){var t=this;this.base.getResources().then((function(){t.env=new r.Env(t.base),t.trigger("env-ready"),clearTimeout(t.initTimeout),t.initTimeout=setTimeout((function(){t.cube=new s.Cube(t.base),t.domCube=new a.DomCube(t.base),t.ready=!0,t.trigger("ready")}),t.initTimeoutDuration)}))},e.prototype.showChat=function(){this.cube.showChat(),this.domCube.showChat(),this.base.getLoginStatus()?this.domCube.chat.showScreen("guestList"):this.domCube.chat.showScreen("loginGuide")},e.prototype.showMusic=function(){this.cube.showMusic(),this.domCube.showMusic()},e.prototype.update=function(t){this.ready&&(this.env.update(t),this.cube.update(t),this.domCube.update(t))},e}(n(774).EventEmitter);e.Playground=c},6911:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=void 0;var i=n(691),o=n(1564),r=function(){function t(t){this.base=t,this.sizer=this.base.sizer,this.canvas=this.base.canvas,this.domCanvas=this.base.domCanvas,this.scene=this.base.scene,this.scene2=this.base.scene2,this.camera=this.base.camera,this.setInstances()}return t.prototype.setInstances=function(){this.instance=new i.WebGLRenderer({canvas:this.canvas,antialias:!0,preserveDrawingBuffer:!0}),this.instance.physicallyCorrectLights=!0,this.instance.toneMappingExposure=1.75,this.instance.shadowMap.enabled=!0,this.instance.shadowMap.type=i.PCFSoftShadowMap,this.instance.setClearColor(16777215),this.instance2=new o.CSS3DRenderer({element:this.domCanvas}),this.sizing()},t.prototype.resize=function(){this.sizing()},t.prototype.sizing=function(){this.instance.setSize(this.sizer.width,this.sizer.height),this.instance.setPixelRatio(this.sizer.pixelRatio),this.instance2.setSize(this.sizer.width,this.sizer.height)},t.prototype.update=function(){this.instance.render(this.scene,this.camera.instance),this.instance2.render(this.scene2,this.camera.instance)},t}();e.Renderer=r},17:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Chat=void 0;var r=n(691),s=n(1564),a=n(774),c=n(4768),u=function(t){function e(e){var n=t.call(this)||this;return n.base=e,n.offset=1.7,n.pos=new r.Vector3(0,0,n.offset),n.normal=new r.Vector3(0,0,1),n.cNormal=new r.Vector3,n.cPos=new r.Vector3,n.m4=new r.Matrix4,n.setElement(),n}return o(e,t),e.prototype.setElement=function(){this.element=this.base.domBundle.querySelector("#chat-main-cube"),this.chatMainInner=this.element.querySelector("#chat-main-inner"),this.loginGuide=this.element.querySelector("#login-guide"),this.guestList=this.element.querySelector("#guest-list"),this.loginGuideBtn=this.element.querySelector("#login-guide-button"),this.object=new s.CSS3DObject(this.element),this.object.position.set(0,0,this.offset),this.object.scale.set(1/160,1/160,1),this.bindElementEvents()},e.prototype.showScreen=function(t){var e=this,n="chat-main__inner--hide";this[t].classList.remove(n),["chatMainInner","loginGuide","guestList"].filter((function(e){return e!==t})).forEach((function(t){var i;null===(i=e[t])||void 0===i||i.classList.add(n)}))},e.prototype.refreshGuestList=function(t){var e=this.guestList.querySelector("#guest-list-container");e.innerHTML="";var n="";t.forEach((function(t,e){var i='\n           <li class="guest-list__li guest" style="animation-delay:'.concat(200*e,'ms">\n                <div class="guest__name">').concat(t.username,"</div>\n            </li>\n            ");n+=i})),e.innerHTML=n},e.prototype.bindElementEvents=function(){var t=this;this.loginGuideBtn.addEventListener("pointerdown",(function(){t.trigger("cube-login-button-click")}))},e.prototype.setGuestNumber=function(t){this.guestList.querySelector("#guest-number").innerHTML="NOW ONLINE: ".concat(t)},e.prototype.update=function(){(0,c.updateOcclude)(this)},e}(a.EventEmitter);e.Chat=u},5659:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Clock=void 0;var i=n(691),o=n(1564),r=n(4768),s=function(){function t(t){this.base=t,this.offset=1.7,this.pos=new i.Vector3(-this.offset,0,0),this.normal=new i.Vector3(-1,0,0),this.cNormal=new i.Vector3,this.cPos=new i.Vector3,this.m4=new i.Matrix4,this.setElement()}return t.prototype.setElement=function(){this.element=this.base.domBundle.querySelector("#clock"),this.object=new o.CSS3DObject(this.element),this.object.position.set(-this.offset,0,0),this.object.rotation.y=-Math.PI/2,this.object.scale.set(1/160,1/160,1),this.initClock()},t.prototype.updateClock=function(){for(var t=new Date,e=t.getSeconds(),n=t.getMinutes(),i=t.getHours(),o=t.getMonth(),s=t.getDate(),a=t.getFullYear(),c=["mon","d","y","h","m","s"],u=[["January","February","March","April","May","June","July","August","September","October","November","December"][o],s,a,(0,r.pad)(i,2),(0,r.pad)(n,2),(0,r.pad)(e,2)],h=0;h<c.length;h++)this.element.querySelector("#".concat(c[h])).innerHTML=u[h].toString()},t.prototype.initClock=function(){this.updateClock(),this.timer=setInterval(this.updateClock.bind(this),1e3)},t.prototype.update=function(){(0,r.updateOcclude)(this)},t}();e.Clock=s},1648:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(17),e)},475:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Music=void 0;var i=n(691),o=n(1564),r=n(4768),s=n(7437),a=n(3570),c=n(8029),u=function(){function t(t){this.base=t,this.offset=1.7,this.pos=new i.Vector3(this.offset,0,0),this.normal=new i.Vector3(1,0,0),this.cNormal=new i.Vector3,this.cPos=new i.Vector3,this.m4=new i.Matrix4,this.defaultSource="https%3A//api.soundcloud.com/tracks/327386009",this.playStatus=!1,this.setElement()}return t.prototype.setElement=function(){this.element=this.base.domBundle.querySelector("#music-player"),this.object=new o.CSS3DObject(this.element),this.object.position.set(this.offset,0,0),this.object.rotation.y=Math.PI/2,this.object.scale.set(1/160,1/160,1),this.init()},t.prototype.bindPlayerUIEvent=function(){var t=this,e=this.element.querySelector("#music-player-button"),n=this.element.querySelector("#music-player-img img"),i=this.element.querySelector("#music-player-title span"),o=this.element.querySelector("#music-player-artist span"),r=this.element.querySelector("#music-player-perma-link"),u=this.element.querySelector("#music-player-waveform"),h=u.getBoundingClientRect();e.addEventListener("pointerdown",(function(){t.playStatus?s.widget.pause():s.widget.play(),t.playStatus=!t.playStatus})),s.widget.on("play",(function(){e.classList.add("music-player__btn--pause"),t.playStatus=!0})),s.widget.on("pause",(function(){t.waveformInstance&&(e.classList.remove("music-player__btn--pause"),t.playStatus=!1,t.waveformInstance.pause())})),r.addEventListener("pointerdown",(function(t){var e=t.currentTarget.href;window.open(e,"_blank")})),s.widget.on("play-progress",(function(e){t.waveformInstance&&t.waveformInstance.playProgress(e)})),s.widget.on("load",(function(e){var l,p="";p=e.artwork_url?e.artwork_url.replace(/(.*)(-large)(\.[a-z0-9]{3}[a-z0-9]?)$/,"$1-t500x500$3"):"./assets/images/not-found.jpg",n.src=p,i.innerHTML=null==e?void 0:e.title,o.innerHTML=(null===(l=null==e?void 0:e.publisher_metadata)||void 0===l?void 0:l.artist)||"Unknown",r.href=null==e?void 0:e.permalink_url,c({url:e.waveform_url}).then((function(n){u.innerHTML="";var i=n.data.samples.map((function(t){return(t-128)/100*5+1.28}));t.waveformInstance=new a.Waveform({container:u,data:i,width:h.width,height:h.height,trackLength:i.length,reflection:.3,waveWidth:2,interpolate:!0,fadeOpacity:.888,bindResize:!1}),t.waveformInstance.on(a.EVENT_CLICK,(function(n){var i=n/100;s.widget.seek(i*(null==e?void 0:e.duration)),t.waveformInstance.playProgress(n)}))})).catch((function(t){throw t}))}))},t.prototype.init=function(){this.bindPlayerUIEvent(),s.widget.load(this.defaultSource)},t.prototype.update=function(){(0,r.updateOcclude)(this)},t}();e.Music=u},9702:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpaceInvader=void 0;var i=n(691),o=n(1564),r=n(4768),s=function(){function t(t){this.base=t,this.offset=1.7,this.pos=new i.Vector3(0,0,-this.offset),this.normal=new i.Vector3(0,0,-1),this.cNormal=new i.Vector3,this.cPos=new i.Vector3,this.m4=new i.Matrix4,this.setElement()}return t.prototype.setElement=function(){this.element=this.base.domBundle.querySelector("#space-invader"),this.object=new o.CSS3DObject(this.element),this.object.position.set(0,0,-this.offset),this.object.rotation.y=-Math.PI,this.object.scale.set(1/160,1/160,1)},t.prototype.update=function(){(0,r.updateOcclude)(this)},t}();e.SpaceInvader=s},2367:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),r=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},s=this&&this.__generator||function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0});var a,c,u,h=n(9735),l=n(3859),p=n(6486),d=n(4768),f=n(9794),v=function(t){function e(e,n,i){var o=t.call(this,e,n,i)||this;return o.wrapper=document.querySelector("#wrapper"),o.chatBlock=document.querySelector("#chat-block"),o.rotationLock=o.chatBlock.querySelector("#rotation-lock"),o.curtainCall=document.querySelector("#curtain-call"),o.chatBlockActive=!1,o.path="https://3d-cube-chat.fly.dev",o.init(),o}return o(e,t),e.prototype.init=function(){this.initCurtainCall(),this.initChatUI(),this.initMusicUI()},e.prototype.toggleRotationLockFromUI=function(){var t=this.getRotationLockStatus();t?this.rotationLock.classList.remove("chat-block__rotation-lock--active"):this.rotationLock.classList.add("chat-block__rotation-lock--active"),this.setRotationLock(!t)},e.prototype.setRotationLockFromUI=function(t){t?this.rotationLock.classList.add("chat-block__rotation-lock--active"):this.rotationLock.classList.remove("chat-block__rotation-lock--active"),this.setRotationLock(t)},e.prototype.initCurtainCall=function(){var t=this;this.playground.on("env-ready",(function(){t.curtainCall.classList.add("curtain-call--hide")}))},e.prototype.initChatUI=function(){var t=this,e=this.chatBlock.querySelector("#chat-block-toggler"),n=this.chatBlock.querySelector("#login-button"),i=this.chatBlock.querySelector("#send-message-button"),o=this.chatBlock.querySelector("#logout-button");e.addEventListener(f.pointerEvent,(function(){var e;t.chatBlockActive?(t.wrapper.classList.remove("wrapper--active"),e=t.getLoginStatus()?"chatMainInner":"loginGuide",t.setRotationLockFromUI(!1)):(t.wrapper.classList.add("wrapper--active"),e=t.getLoginStatus()?"guestList":"loginGuide",t.setRotationLockFromUI(!0),t.playground.showChat()),t.playground.domCube.chat.showScreen(e),t.chatBlockActive=!t.chatBlockActive})),this.playground.on("ready",(function(){t.playground.domCube.chat.showScreen("loginGuide"),t.playground.domCube.chat.on("cube-login-button-click",(function(){var e,n;t.setRotationLockFromUI(!0),1==(e=!0)?(t.wrapper.classList.add("wrapper--active"),n=t.getLoginStatus()?"guestList":"loginGuide",t.getLoginStatus()&&t.setRotationLockFromUI(!0),t.playground.showChat()):(t.wrapper.classList.remove("wrapper--active"),n=t.getLoginStatus()?"chatMainInner":"loginGuide",t.setRotationLockFromUI(!1)),t.playground.domCube.chat.showScreen(n),t.chatBlockActive=e}))})),this.rotationLock.addEventListener(f.pointerEvent,this.toggleRotationLockFromUI.bind(this)),n.addEventListener(f.pointerEvent,(function(){t.myName=(0,p.trim)(t.chatBlock.querySelector("#login-name").value),t.myName?(t.socket=(0,l.io)(t.path),t.initChatSocket(),t.socket.emit("login",{username:t.myName})):(0,f.doAlert)("Please enter a name :)")})),i.addEventListener(f.pointerEvent,(function(){t.sendMessage()})),o.addEventListener(f.pointerEvent,(function(){return r(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,(0,f.doConfirm)("Are you sure you want to leave the chat?")];case 1:return t.sent()&&this.socket.emit("logout",{username:this.myName}),[2]}}))}))})),document.addEventListener("keydown",(function(e){13==e.keyCode&&t.sendMessage()}))},e.prototype.initMusicUI=function(){var t,e=this;this.chatBlock.querySelector("#search-music-button").addEventListener(f.pointerEvent,(function(){return r(e,void 0,void 0,(function(){var e=this;return s(this,(function(n){switch(n.label){case 0:return this.setRotationLockFromUI(!0),this.playground.showMusic(),[4,(0,f.searchMusic)().then((function(n){n?(0,f.playViaIframe)(n).then((function(){clearTimeout(t),t=setTimeout((function(){e.setRotationLockFromUI(!1)}),1e3)})):e.setRotationLockFromUI(!1)}))];case 1:return n.sent(),[2]}}))}))}))},e.prototype.initChatSocket=function(){var t=this;this.socket.on("loginSuccess",(function(e){e.username===t.myName?t.checkIn(e):(0,f.doAlert)("Wrong username:( Please try again!")})),this.socket.on("loginFail",(function(){(0,f.doAlert)("Duplicate name already exists :(")})),this.socket.on("add",(function(e){"<p>".concat(e.username," 加入聊天室</p>");t.playground.domCube.chat.setGuestNumber(e.userCount),t.playground.domCube.chat.refreshGuestList(null==e?void 0:e.users)})),this.socket.on("leaveSuccess",(function(){t.checkOut()})),this.socket.on("leave",(function(e){if(null!=e.username){t.playground.domCube.chat.refreshGuestList(null==e?void 0:e.users);"<p>".concat(e.username," 退出聊天室</p>");t.playground.domCube.chat.setGuestNumber(e.userCount)}})),this.socket.on("receiveMessage",(function(e){t.showMessage(e)}))},e.prototype.checkIn=function(t){var e=this.chatBlock.querySelector("#login");this.chatBlock.querySelector("#my-name").innerHTML=t.username,e.classList.add("login--logined"),this.setRotationLockFromUI(!0),this.setLoginStatus(!0),this.playground.showChat()},e.prototype.checkOut=function(){this.chatBlock.querySelector("#login").classList.remove("login--logined"),this.playground.domCube.chat.showScreen("loginGuide"),this.chatBlock.querySelector("#chat-main").innerHTML="",this.setLoginStatus(!1)},e.prototype.sendMessage=function(){var t=this.chatBlock.querySelector("#message-input"),e=t.value;t.value="",e&&this.socket.emit("sendMessage",{username:this.myName,message:e})},e.prototype.showMessage=function(t){var e;e=t.username===this.myName?'<div class="chat-main__chat ">\n                        <div class="chat-main__bubble-name">You</div>\n                        <div class="chat-main__bubble">'.concat(t.message,"</div>\n                    </div>\n                    "):'<div class="chat-main__chat chat-main__chat--other">\n                        <div class="chat-main__bubble-name">'.concat(t.username,'</div>\n                        <div class="chat-main__bubble">').concat(t.message,"</div>\n                    </div>\n                    ");var n=(0,d.createElementFromHTML)(e),i=this.chatBlock.querySelector("#chat-main"),o=this.wrapper.querySelector("#chat-main-cube .chat-main__inner#chat-main-inner");i.appendChild(n),o.appendChild(n.cloneNode(!0)),i.parentElement.scrollTop=i.scrollHeight,o.scrollTop=o.scrollHeight},e}(h.Base);a=document.querySelector("#canvas"),c=document.querySelector("#dom-canvas"),u=document.querySelector("#dom-bundle"),new v(a,c,u)},6076:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Cube=void 0;var i=n(6358),o=n(691),r=n(4768),s=function(){function t(t){this.base=t,this.setModel()}return t.prototype.createRoundedBoxGeo=function(t,e,n,i,r){var s=new o.Shape,a=1e-5,c=i-a,u=.25;s.absarc(a,a,u,-Math.PI/2,-Math.PI,!0),s.absarc(a,e-2*c,u,Math.PI,Math.PI/2,!0),s.absarc(t-2*c,e-2*c,u,Math.PI/2,0,!0),s.absarc(t-2*c,a,u,0,-Math.PI/2,!0);var h=new o.ExtrudeGeometry(s,{depth:n-i,bevelEnabled:!0,bevelSegments:2*r,steps:1,bevelSize:c,bevelThickness:i,curveSegments:r});return h.center(),h},t.prototype.setModel=function(){var t,e,n=this.createRoundedBoxGeo(3,3,3,.4,20),i=new o.MeshMatcapMaterial({matcap:this.base.resources.cubeMatcap});this.group=new o.Group,this.mesh=new o.Mesh(n,i),(t=this.mesh.scale).set.apply(t,r.cubeLikeConfig.initialScale),(e=this.mesh.rotation).set.apply(e,r.cubeLikeConfig.initialRotation),this.group.add(this.mesh),this.base.scene.add(this.group),this.doAnimation()},t.prototype.doAnimation=function(){i.default.to(this.mesh.rotation,r.cubeLikeConfig.startAnimationInnerRotationConfig),i.default.to(this.mesh.scale,r.cubeLikeConfig.startAnimationInnerScalingConfig)},t.prototype.showChat=function(){var t=this;i.default.to(this.base.camera.instance.position,{x:this.base.camera.bestPoint.x,y:this.base.camera.bestPoint.y,z:this.base.camera.bestPoint.z,duration:4,onStart:function(){t.base.camera.controls.enabled=!1,t.base.camera.controls.enableDamping=!1},onComplete:function(){t.base.camera.controls.enabled=!0,t.base.camera.controls.enableDamping=!0}}),i.default.to(this.mesh.rotation,r.cubeLikeConfig.showChatAnimationInnerRotationConfig);var e=(0,r.getTargetAngle)(this.group.rotation.y);i.default.to(this.group.rotation,{x:0,y:e,z:0,duration:2})},t.prototype.showMusic=function(){var t=this;i.default.to(this.base.camera.instance.position,{x:this.base.camera.bestPoint.x,y:this.base.camera.bestPoint.y,z:this.base.camera.bestPoint.z,duration:4,onStart:function(){t.base.camera.controls.enabled=!1,t.base.camera.controls.enableDamping=!1},onComplete:function(){t.base.camera.controls.enabled=!0,t.base.camera.controls.enableDamping=!0}}),i.default.to(this.mesh.rotation,r.cubeLikeConfig.showMusicAnimationInnerRotationConfig);var e=(0,r.getTargetAngle)(this.group.rotation.y);i.default.to(this.group.rotation,{x:0,y:e-Math.PI/4,z:0,duration:2})},t.prototype.update=function(t){this.base.touched||this.base.getRotationLockStatus()||(this.group.rotation.y+=t/r.cubeLikeConfig.updateParameter)},t}();e.Cube=s},4868:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DomCube=void 0;var i=n(691),o=n(1648),r=n(9702),s=n(6358),a=n(5659),c=n(4768),u=n(475),h=function(){function t(t){this.base=t,this.groupOuter=new i.Group,this.groupInner=new i.Group,this.init()}return t.prototype.init=function(){var t,e;this.chat=new o.Chat(this.base),this.clock=new a.Clock(this.base),this.music=new u.Music(this.base),this.spaceInvader=new r.SpaceInvader(this.base),(t=this.groupInner.scale).set.apply(t,c.cubeLikeConfig.initialScale),(e=this.groupInner.rotation).set.apply(e,c.cubeLikeConfig.initialRotation),this.groupInner.add(this.chat.object),this.groupInner.add(this.clock.object),this.groupInner.add(this.music.object),this.groupInner.add(this.spaceInvader.object),this.groupOuter.add(this.groupInner),this.base.scene2.add(this.groupOuter),this.doAnimation()},t.prototype.doAnimation=function(){s.default.to(this.groupInner.rotation,c.cubeLikeConfig.startAnimationInnerRotationConfig),s.default.to(this.groupInner.scale,c.cubeLikeConfig.startAnimationInnerScalingConfig)},t.prototype.showChat=function(){s.default.to(this.groupInner.rotation,c.cubeLikeConfig.showChatAnimationInnerRotationConfig);var t=(0,c.getTargetAngle)(this.groupOuter.rotation.y);s.default.to(this.groupOuter.rotation,{x:0,y:t,z:0,duration:2})},t.prototype.showMusic=function(){s.default.to(this.groupInner.rotation,c.cubeLikeConfig.showMusicAnimationInnerRotationConfig);var t=(0,c.getTargetAngle)(this.groupOuter.rotation.y);s.default.to(this.groupOuter.rotation,{x:0,y:t-Math.PI/4,z:0,duration:2})},t.prototype.update=function(t){this.base.touched||this.base.getRotationLockStatus()||(this.groupOuter.rotation.y+=t/c.cubeLikeConfig.updateParameter),this.chat.update(),this.clock.update(),this.music.update(),this.spaceInvader.update()},t}();e.DomCube=h},392:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(6076),e)},5048:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getResources=void 0;var i=n(8394),o=n(691),r=new o.TextureLoader,s=new o.CubeTextureLoader,a=function(t){return new Promise((function(e,n){r.load(t.path,(function(n){e({name:t.name,content:n})}),null,n)}))},c=function(t){return new Promise((function(e,n){s.load(t.paths,(function(n){e({name:t.name,content:n})}),null,(function(t){console.log(t)}))}))};e.getResources=function(){for(var t=[],e=0,n=i.textureSources;e<n.length;e++){var o=n[e];switch(o.type){case"cubeTexture":t.push(c(o));break;case"texture":t.push(a(o))}}return Promise.all(t).then((function(t){var e={};return t.forEach((function(t){e[t.name]=t.content})),e}))}},8394:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.textureSources=void 0,e.textureSources=[{name:"gradientCubeTexture",type:"cubeTexture",paths:["./assets/images/cubemap/gs-gradient/px.png","./assets/images/cubemap/gs-gradient/nx.png","./assets/images/cubemap/gs-gradient/py.png","./assets/images/cubemap/gs-gradient/ny.png","./assets/images/cubemap/gs-gradient/pz.png","./assets/images/cubemap/gs-gradient/nz.png"]},{name:"cubeMatcap",type:"texture",path:"./assets/images/matcap/BlackRough.png"}]},3111:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventEmitter=void 0;var n=function(){function t(){this.callbacks={},this.callbacks={},this.callbacks.base={}}return t.prototype.on=function(t,e){var n=this;return void 0===t||""===t?(console.warn("wrong names"),!1):void 0===e?(console.warn("wrong callback"),!1):(this.resolveNames(t).forEach((function(t){var i=n.resolveName(t);n.callbacks[i.namespace]instanceof Object||(n.callbacks[i.namespace]={}),n.callbacks[i.namespace][i.value]instanceof Array||(n.callbacks[i.namespace][i.value]=[]),n.callbacks[i.namespace][i.value].push(e)})),this)},t.prototype.off=function(t){var e=this;return void 0===t||""===t?(console.warn("wrong name"),!1):(this.resolveNames(t).forEach((function(t){var n=e.resolveName(t);if("base"!==n.namespace&&""===n.value)delete e.callbacks[n.namespace];else if("base"===n.namespace)for(var i in e.callbacks)e.callbacks[i]instanceof Object&&e.callbacks[i][n.value]instanceof Array&&(delete e.callbacks[i][n.value],0===Object.keys(e.callbacks[i]).length&&delete e.callbacks[i]);else e.callbacks[n.namespace]instanceof Object&&e.callbacks[n.namespace][n.value]instanceof Array&&(delete e.callbacks[n.namespace][n.value],0===Object.keys(e.callbacks[n.namespace]).length&&delete e.callbacks[n.namespace])})),this)},t.prototype.trigger=function(t,e){var n=this;if(void 0===t||""===t)return console.warn("wrong name"),!1;var i=null,o=null,r=e instanceof Array?e:[],s=this.resolveNames(t),a=this.resolveName(s[0]);if("base"===a.namespace)for(var c in this.callbacks)this.callbacks[c]instanceof Object&&this.callbacks[c][a.value]instanceof Array&&this.callbacks[c][a.value].forEach((function(t){o=t.apply(n,r),void 0===i&&(i=o)}));else if(this.callbacks[a.namespace]instanceof Object){if(""===a.value)return console.warn("wrong name"),this;this.callbacks[a.namespace][a.value].forEach((function(t){o=t.apply(n,r),void 0===i&&(i=o)}))}return i},t.prototype.resolveNames=function(t){var e=t;return e=(e=(e=e.replace(/[^a-zA-Z0-9 ,/.]/g,"")).replace(/[,/]+/g," ")).split(" ")},t.prototype.resolveName=function(t){var e={},n=t.split(".");return e.original=t,e.value=n[0],e.namespace="base",n.length>1&&""!==n[1]&&(e.namespace=n[1]),e},t}();e.EventEmitter=n},4768:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getTargetAngle=e.createElementFromHTML=e.cubeLikeConfig=e.pad=e.updateOcclude=void 0,e.updateOcclude=function(t){var e=t.base.playground.cube.mesh;t.cNormal.copy(t.normal).applyMatrix3(e.normalMatrix),t.cPos.copy(t.pos).applyMatrix4(t.m4.multiplyMatrices(t.base.camera.instance.matrixWorldInverse,e.matrixWorld));var n=t.cPos.negate().dot(t.cNormal);t.element.style.visibility=n<0?"hidden":"visible"},e.pad=function(t,e){for(var n=t.toString();n.length<e;n=0+n);return n},e.cubeLikeConfig={initialScale:[0,0,0],initialRotation:[Math.PI/3,-Math.PI/3,Math.PI/3],startAnimationInnerRotationConfig:{x:0,y:Math.PI/4,z:0,duration:2},startAnimationInnerScalingConfig:{x:1,y:1,z:1,duration:2},showChatAnimationInnerRotationConfig:{x:0,y:-Math.PI/4,z:0,duration:2},showMusicAnimationInnerRotationConfig:{x:0,y:-Math.PI/4,z:0,duration:2},showChatAnimationOuterRotationConfig:{x:0,y:0,z:0,duration:2},updateParameter:5},e.createElementFromHTML=function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild},e.getTargetAngle=function(t){var e=t%(2*Math.PI),n=t-e-.25*Math.PI,i=t+(7*Math.PI/4-e);return e<Math.PI?n:i}},774:function(t,e,n){"use strict";var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(3111),e),o(n(1600),e),o(n(5388),e)},9794:function(t,e,n){"use strict";var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,r){function s(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,i,o,r,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return r={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function a(r){return function(a){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){s=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){s.label=r[1];break}if(6===r[0]&&s.label<o[1]){s.label=o[1],o=r;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(r);break}o[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,a])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.playViaIframe=e.searchMusic=e.doAlert=e.doConfirm=e.pointerEvent=void 0;var r=n(7437),s=n(7156),a=n(3805),c=new s.SoundCloudService({clientId:"jOJjarVXJfZlI309Up55k93EUDG7ILW6"});function u(t,e){return i(this,void 0,void 0,(function(){var n,i,s,a,u;return o(this,(function(o){switch(o.label){case 0:return c?(n=t.querySelector("#search-music-result"),(i=e.value)?(n.innerHTML='\n        <li class="modal-music-search__li modal-music-search__li--loading">\n           <img src="./assets/images/ripple.svg">\n        </li>\n        ',[4,c.search({q:i,limit:100}).then((function(t){return r.widget.trigger("search",[t]),t}))]):[2]):[2];case 1:return s=o.sent(),a=null==s?void 0:s.collection.filter((function(t){return"all"===t.embeddable_by&&!!t.title})),u=a.map((function(t,e){var n,i;return'\n            <li class="modal-music-search__li music-search-item" style="animation-delay:'.concat(100*e,'ms">\n                <div class="music-search-item__inner">\n                    <div class="music-search-item__head">\n                        <div class="music-search-item__img">\n                            <img src="').concat(t.artwork_url,'" onerror="this.parentNode.classList.add(\'music-search-item__img--not-found\')" >\n                        </div>\n                    </div>\n                    <div class="music-search-item__body">\n                        <div class="music-search-item__title">\n                            <span>').concat(t.title,'</span>\n                        </div>\n                        <div class="music-search-item__descrp">\n                            <div class="music-search-item__artist">\n                            ').concat((null===(n=t.publisher_metadata)||void 0===n?void 0:n.artist)||"Unknown",'\n                            </div>\n                            <div class="music-search-item__album-title">').concat((null===(i=t.publisher_metadata)||void 0===i?void 0:i.album_title)||"",'</div>\n                        </div>\n                    </div>\n                    <button class="music-search-item__play" action="choose" data-id="').concat(t.id,'">\n                    </button>\n                </div>\n            </li>\n            ')})).join(""),n.scrollTop=0,n.innerHTML=u,[2]}}))}))}e.pointerEvent=a()?"touchstart":"click",e.doConfirm=function(t){var n,i=document.querySelector("#modal-confirm"),o="modal-prompt--active",r=new Promise((function(t){n=t})),s=!1,a=function(t){switch(t.preventDefault(),t.target.closest("[action]").getAttribute("action")){case"yes":s=!0,i.classList.remove(o);break;case"no":s=!1,i.classList.remove(o);break;case"close":i.classList.remove(o)}t.currentTarget.removeEventListener(e.pointerEvent,a),n(s)};return i.querySelector("p").innerHTML=t,i.classList.add(o),i.addEventListener(e.pointerEvent,a),r},e.doAlert=function(t){var n=document.querySelector("#modal-alert"),i="modal-prompt--active",o=function(t){t.preventDefault(),"close"===t.target.closest("[action]").getAttribute("action")&&(t.currentTarget.removeEventListener(e.pointerEvent,o),n.classList.remove(i))};n.querySelector("p").innerHTML=t,n.classList.add(i),n.addEventListener(e.pointerEvent,o)},e.searchMusic=function(){var t,n,r=this,s=document.querySelector("#modal-music-search"),a="modal-music-search--active",c=s.querySelector("#music-search-input"),h=new Promise((function(e,n){t=e})),l=function(t){13==t.keyCode&&c.value&&document.activeElement===c&&u(s,c)},p=function(h){return i(r,void 0,void 0,(function(){var i,r;return o(this,(function(o){return i=h.target.closest("[action]")||h.target,"close"===(r=i.getAttribute("action"))?(h.currentTarget.removeEventListener(e.pointerEvent,p),document.removeEventListener("keydown",l),s.classList.remove(a),t(!1)):"search"===r?u(s,c):"choose"===r&&(n=i.getAttribute("data-id")||"",h.currentTarget.removeEventListener(e.pointerEvent,p),document.removeEventListener("keydown",l),s.classList.remove(a),t(n)),[2]}))}))};return s.classList.add(a),s.addEventListener(e.pointerEvent,p),document.addEventListener("keydown",l),h},e.playViaIframe=function(t){var e="https%3A//api.soundcloud.com/tracks/".concat(t);return r.widget.load(e).then((function(){r.widget.play()}))}},5388:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Sizer=void 0;var r=function(t){function e(e){var n=t.call(this)||this;return n.canvas=e,n.pixelRatio=Math.min(window.devicePixelRatio,2),n.initSizingMechanic(),n}return o(e,t),e.prototype.initSizingMechanic=function(){this.sizing(),window.addEventListener("resize",this.sizing.bind(this))},e.prototype.sizing=function(){var t=this.canvas.parentElement.getBoundingClientRect();this.width=t.width,this.height=t.height,this.trigger("resize",[this.width,this.height])},e}(n(3111).EventEmitter);e.Sizer=r},7156:(t,e,n)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SoundCloudService=void 0;var i=n(8029),o=function(){function t(t){this.config=t}return t.prototype.search=function(t){var e=this;return new Promise((function(n,o){t.client_id=t.client_id?t.client_id:e.config.clientId;var r=Object.entries(t).map((function(t){return t.join("=")})).join("&"),s="".concat("https://cors-proxy-server.onrender.com/","https://api-v2.soundcloud.com").concat("/search/tracks","?").concat(r);i({url:s}).then((function(t){return n(t.data)})).catch((function(t){return o(t)}))}))},t}();e.SoundCloudService=o},1600:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Ticker=void 0;var r=n(3111),s=n(691),a=function(t){function e(){var e=t.call(this)||this;return e.clock=new s.Clock,window.requestAnimationFrame((function(){e.tick()})),e}return o(e,t),e.prototype.tick=function(){var t=this;this.trigger("tick",[this.clock]),window.requestAnimationFrame((function(){t.tick()}))},e}(r.EventEmitter);e.Ticker=a},3570:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Waveform=e.EVENT_RESIZED=e.EVENT_HOVER=e.EVENT_CLICK=e.EVENT_READY=e.REFLECTION_ACTIVE=e.REFLECTION=e.GUTTER_SELECTED=e.GUTTER_ACTIVE=e.GUTTER=e.WAVE_SELECTED=e.WAVE_ACTIVE=e.WAVE=e.WAVE_FOCUS=e.DEFAULT_MIN_OPACITY=e.DEFAULT_MAX_OPACITY=void 0;var r=n(3111);e.DEFAULT_MAX_OPACITY=1,e.DEFAULT_MIN_OPACITY=.2,e.WAVE_FOCUS="waveFocus",e.WAVE="wave",e.WAVE_ACTIVE="waveActive",e.WAVE_SELECTED="waveSelected",e.GUTTER="gutter",e.GUTTER_ACTIVE="gutterActive",e.GUTTER_SELECTED="gutterSelected",e.REFLECTION="reflection",e.REFLECTION_ACTIVE="reflectionActive",e.EVENT_READY="ready",e.EVENT_CLICK="click",e.EVENT_HOVER="hover",e.EVENT_RESIZED="hover";var s=function(t){function n(n){var i=t.call(this)||this;if(i.DEFAULT_MAX_OPACITY=e.DEFAULT_MAX_OPACITY,i.DEFAULT_MIN_OPACITY=e.DEFAULT_MIN_OPACITY,i.WAVE_FOCUS=e.WAVE_FOCUS,i.WAVE=e.WAVE,i.WAVE_ACTIVE=e.WAVE_ACTIVE,i.WAVE_SELECTED=e.WAVE_SELECTED,i.GUTTER=e.GUTTER,i.GUTTER_ACTIVE=e.GUTTER_ACTIVE,i.GUTTER_SELECTED=e.GUTTER_SELECTED,i.REFLECTION=e.REFLECTION,i.REFLECTION_ACTIVE=e.REFLECTION_ACTIVE,i.EVENT_READY=e.EVENT_READY,i.EVENT_CLICK=e.EVENT_CLICK,i.EVENT_HOVER=e.EVENT_HOVER,i.EVENT_RESIZED=e.EVENT_RESIZED,i.data=[],i.outerColor="transparent",i.reflection=0,i.interpolate=!0,i.bindResize=!1,i.fadeOpacity=.5,i.wavesCollection=[],i.width=0,i.height=0,i.waveWidth=2,i.gutterWidth=1,i.waveOffset=0,i.reflectionHeight=0,i.waveHeight=0,i.colors={},i.active=-1,i.clickPercent=0,i.selected=-1,i.isPlaying=!1,i.hasStartedPlaying=!1,i.trackLength=0,Object.assign(i,n),!i.canvas){if(!i.container)throw"Either canvas or container option must be passed";i.spawnCanvas(n.width||i.container.clientWidth,n.height||i.container.clientHeight),i.width=parseInt(i.context.canvas.width.toString(),10),i.height=parseInt(i.context.canvas.height.toString(),10)}if(i.fadeOpacity=i.fadeOpacity||i.DEFAULT_MAX_OPACITY,isNaN(i.fadeOpacity))throw new Error("Fade Opacity Can Only Be A Number");if(i.fadeOpacity<i.DEFAULT_MIN_OPACITY||i.fadeOpacity>i.DEFAULT_MAX_OPACITY)throw new Error("Fade Opacity Can Only Be A Number Between "+i.DEFAULT_MIN_OPACITY+" and "+i.DEFAULT_MAX_OPACITY);return i.initialize(),i}return o(n,t),n.prototype.spawnCanvas=function(t,e){this.canvas=document.createElement("canvas"),this.container.appendChild(this.canvas),this.canvas.width=t,this.canvas.height=e,this.context=this.canvas.getContext("2d")},n.prototype.initialize=function(){this.updateHeight(),this.setColors(),this.bindEventHandlers(),this.cache(),this.redraw(),!0===this.bindResize&&this.bindContainerResize(),this.fireEvent(this.EVENT_READY)},n.prototype.updateHeight=function(){this.waveOffset=Math.round(this.height-this.height*this.reflection),this.reflectionHeight=Math.round(this.height-this.waveOffset),this.waveHeight=this.height-this.reflectionHeight},n.prototype.setColors=function(){this.setColor(this.WAVE_FOCUS,"#333333"),this.setGradient(this.WAVE,[{color:"#666666",offset:0},{color:"#868686",offset:1}]),this.setGradient(this.WAVE_ACTIVE,[{color:"#FF3300",offset:0},{color:"#FF5100",offset:1}]),this.setGradient(this.WAVE_SELECTED,[{color:"#993016",offset:0},{color:"#973C15",offset:1}]),this.setGradient(this.GUTTER,[{color:"#6B6B6B",offset:0},{color:"#c9c9c9",offset:1}]),this.setGradient(this.GUTTER_ACTIVE,[{color:"#FF3704",offset:0},{color:"#FF8F63",offset:1}]),this.setGradient(this.GUTTER_SELECTED,[{color:"#9A371E",offset:0},{color:"#CE9E8A",offset:1}]),this.setColor(this.REFLECTION,"#999999"),this.setColor(this.REFLECTION_ACTIVE,"#FFC0A0")},n.prototype.setColor=function(t,e){this.colors[t]=e},n.prototype.setGradient=function(t,e){var n,i;for(n=this.context.createLinearGradient(0,this.waveOffset,0,0),i=0;i<e.length;)n.addColorStop(e[i].offset,e[i].color),i+=1;this.colors[t]=n},n.prototype.getMouseClickPosition=function(t){var e,n;return n=(e=this.canvas).getBoundingClientRect(),[Math.round((t.clientX-n.left)/(n.right-n.left)*e.width),Math.round((t.clientY-n.top)/(n.bottom-n.top)*e.height)]},n.prototype.fireEvent=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.trigger(t,e)},n.prototype.bindEventHandlers=function(){this.canvas.addEventListener("mousedown",this.onMouseDown.bind(this)),this.canvas.addEventListener("mousemove",this.onMouseOver.bind(this)),this.canvas.addEventListener("mouseout",this.onMouseOut.bind(this))},n.prototype.onMouseOut=function(t){this.selected=-1,this.redraw()},n.prototype.onMouseOver=function(t){var e,n,i;if(!0===this.hasStartedPlaying&&!0===this.isPaused())return!0;i=this.getMouseClickPosition(t)[0],n=this.getWaveClicked(i),e=this.getMousePosTrackTime(i),this.fireEvent(this.EVENT_HOVER,e,n),this.selected=n,this.redraw()},n.prototype.onMouseDown=function(t){var e;e=this.getMouseClickPosition(t)[0],this.clickPercent=e/this.width,this.fireEvent(this.EVENT_CLICK,100*this.clickPercent),this.active=this.calcPercent(),this.redraw()},n.prototype.bindContainerResize=function(){var t=this;window.addEventListener("resize",(function(){return function(){var e;return e=t.container.clientWidth,t.update({width:e}),t.redraw(),t.trigger(t.EVENT_RESIZED,[e])}}))},n.prototype.setPlaying=function(t){void 0===t&&(t=!0),this.isPlaying=t},n.prototype.setPaused=function(){this.setPlaying(!1)},n.prototype.isPaused=function(){return this.active>0&&!1===this.isPlaying},n.prototype.play=function(t){this.playProgress(t)},n.prototype.pause=function(){this.setPaused(),console.log("is paused is ",this.isPaused())},n.prototype.playProgress=function(t){var e;null===this.hasStartedPlaying&&(this.hasStartedPlaying=!0),!1===this.isPlaying&&this.setPlaying(!0),e=Math.round(t/100*this.wavesCollection.length),this.active=e,this.redraw()},n.prototype.calcPercent=function(){return Math.round(this.clickPercent*this.width/(this.waveWidth+this.gutterWidth))},n.prototype.getWaveClicked=function(t){var e;return 0,(e=Math.round(t/(this.waveWidth+this.gutterWidth)))>this.wavesCollection.length?this.wavesCollection.length:e<0?0:e},n.prototype.getMousePosTrackTime=function(t){var e;return 0,(e=this.trackLength/this.wavesCollection.length*this.getWaveClicked(t))>this.trackLength?this.trackLength:e<0?0:e},n.prototype.redraw=function(){requestAnimationFrame(this.render.bind(this))},n.prototype.render=function(){var t,e,n,i,o,r,s,a,c,u;for(0,r=this.wavesCollection,this.width/this.data.length,c=0,u=this.waveOffset,this.clear(),i=0,o=r.length,a=[];i<o;)t=r[i],e=r[i+1],this.selected>0&&this.selected<=i&&i<this.active||this.selected>i&&i>=this.active?this.context.fillStyle=this.colors[this.WAVE_SELECTED]:this.active>i?this.context.fillStyle=this.colors[this.WAVE_ACTIVE]:this.context.fillStyle=this.colors[this.WAVE_FOCUS],this.context.fillRect(c,u,this.waveWidth,t),this.selected>0&&this.selected<=i&&i<this.active||this.selected>i&&i>=this.active?this.context.fillStyle=this.colors[this.GUTTER_SELECTED]:this.active>i?this.context.fillStyle=this.colors[this.GUTTER_ACTIVE]:this.context.fillStyle=this.colors[this.GUTTER],n=Math.max(t,e),this.context.fillRect(c+this.waveWidth,u,this.gutterWidth,n),this.reflection>0&&(s=Math.abs(t)/(1-this.reflection)*this.reflection,this.active>0?this.context.fillStyle=this.colors[this.REFLECTION_ACTIVE]:this.context.fillStyle=this.colors[this.REFLECTION],this.context.fillRect(c,u,this.waveWidth,s)),c+=this.waveWidth+this.gutterWidth,a.push(i++);return a},n.prototype.clear=function(){return this.context.fillStyle=this.outerColor,this.context.clearRect(0,0,this.width,this.height),this.context.fillRect(0,0,this.width,this.height)},n.prototype.setData=function(t){return this.data=t},n.prototype.getData=function(){return this.data},n.prototype.setDataInterpolated=function(t){return this.setData(this.interpolateArray(t,this.width))},n.prototype.setDataCropped=function(t){return this.setData(this.expandArray(t,this.width))},n.prototype.linearInterpolate=function(t,e,n){return t+(e-t)*n},n.prototype.expandArray=function(t,e,n){void 0===n&&(n=0);var i,o,r,s=[];if(null===n&&(n=0),t.length>e)s=t.slice(t.length-e,t.length);else for(i=o=0,r=e-1;0<=r?o<=r:o>=r;)s[i]=t[i]||n,i=0<=r?++o:--o;return s},n.prototype.interpolateArray=function(t,e){var n,i,o,r,s,a,c=[];for(s=(t.length-1)/(e-1),c[0]=t[0],r=1;r<e-1;)a=r*s,o=Math.floor(a),n=Math.ceil(a),i=a-o,c[r]=this.linearInterpolate(t[o],t[n],i),r++;return c[e-1]=t[t.length-1],c},n.prototype.putDataIntoWaveBlock=function(){var t,e,n,i,o,r,s,a,c;for(o=this.waveWidth+this.gutterWidth,t=this.getData(),a=[],r=Math.ceil(t.length/o),i=0;i<r;){for(c=0,s=0;s<o;)c+=t[i*o+s],s++;e=c/o*this.waveHeight,n=Math.floor(-Math.abs(e)),a.push(n),i++}return a},n.prototype.cache=function(){!1===this.interpolate?this.setDataCropped(this.data):this.setDataInterpolated(this.data),this.wavesCollection=this.putDataIntoWaveBlock()},n.prototype.update=function(t){t&&(t.gutterWidth&&(this.gutterWidth=t.gutterWidth),t.waveWidth&&(this.waveWidth=t.waveWidth),t.width&&(this.width=t.width,this.canvas.width=this.width),t.height&&(this.height=t.height,this.canvas.height=this.height),(0===t.reflection||t.reflection)&&(this.reflection=t.reflection),t.interpolate&&(this.interpolate=t.interpolate),(t.gutterWidth||t.waveWidth||t.width||t.height||t.reflection||t.interpolate||0===t.reflection)&&this.cache(),(t.height||t.reflection||0===t.reflection)&&this.updateHeight()),this.redraw()},n}(r.EventEmitter);e.Waveform=s},7437:function(t,e,n){"use strict";var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.widget=void 0;var r=n(774),s=n(2252),a=document.querySelector("#soundcloud-iframe"),c=function(t){function e(e){var n=t.call(this)||this;return n.instance=new s(e),n.init(),n}return o(e,t),e.prototype.init=function(){var t=this;this.instance.on(s.events.PLAY,(function(){t.trigger("play")})),this.instance.on(s.events.PLAY_PROGRESS,(function(e){var n=100*e.relativePosition;t.trigger("play-progress",[n])})),this.instance.on(s.events.PAUSE,(function(){t.trigger("pause")})),this.instance.on(s.events.SEEK,(function(e){t.trigger("seek")}))},e.prototype.play=function(){this.instance.play()},e.prototype.pause=function(){this.instance.pause()},e.prototype.toggle=function(){this.instance.toggle()},e.prototype.seek=function(t){this.instance.seekTo(t)},e.prototype.load=function(t){var e=this;return this.instance.load(t,{auto_play:!1}).then((function(){e.instance.getCurrentSound().then((function(t){e.trigger("load",[t])}))}))},e}(r.EventEmitter);e.widget=new c(a)},1163:()=>{},142:()=>{},6854:()=>{},4616:()=>{}},n={};function i(t){var o=n[t];if(void 0!==o)return o.exports;var r=n[t]={id:t,loaded:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}i.m=e,t=[],i.O=(e,n,o,r)=>{if(!n){var s=1/0;for(u=0;u<t.length;u++){for(var[n,o,r]=t[u],a=!0,c=0;c<n.length;c++)(!1&r||s>=r)&&Object.keys(i.O).every((t=>i.O[t](n[c])))?n.splice(c--,1):(a=!1,r<s&&(s=r));a&&(t.splice(u--,1),e=o())}return e}r=r||0;for(var u=t.length;u>0&&t[u-1][2]>r;u--)t[u]=t[u-1];t[u]=[n,o,r]},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t={179:0};i.O.j=e=>0===t[e];var e=(e,n)=>{var o,r,[s,a,c]=n,u=0;for(o in a)i.o(a,o)&&(i.m[o]=a[o]);if(c)var h=c(i);for(e&&e(n);u<s.length;u++)r=s[u],i.o(t,r)&&t[r]&&t[r][0](),t[s[u]]=0;return i.O(h)},n=self.webpackChunkwebpack_playground=self.webpackChunkwebpack_playground||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),i.O(void 0,[736],(()=>i(7310))),i.O(void 0,[736],(()=>i(2367))),i.O(void 0,[736],(()=>i(142)));var o=i.O(void 0,[736],(()=>i(1163)));o=i.O(o)})();
//# sourceMappingURL=main.934a7f4da713fbb25fe0.js.map