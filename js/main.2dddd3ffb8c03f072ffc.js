(()=>{"use strict";var t,e={9735:function(t,e,n){var i=this&&this.__awaiter||function(t,e,n,i){return new(n||(n=Promise))((function(o,a){function s(t){try{c(i.next(t))}catch(t){a(t)}}function r(t){try{c(i.throw(t))}catch(t){a(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,r)}c((i=i.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(a){return function(r){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,r])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Base=void 0;var a=n(6911),s=n(3200),r=n(774),c=n(691),u=n(5048),h=n(7918),l=!1,p=!1,d=function(){function t(t,e,n){this.canvas=t,this.domCanvas=e,this.domBundle=n,this.sizer=new r.Sizer(this.canvas),this.scene=new c.Scene,this.scene2=new c.Scene,this.ticker=new r.Ticker,this.camera=new s.Camera(this),this.renderer=new a.Renderer(this),this.playground=new h.Playground(this),this.touched=!1,this.touchedReactDelay=2e3,this.initResizeMechanic(),this.initTickMechanic(),this.initTouchMechanic()}return t.prototype.initResizeMechanic=function(){var t=this;this.sizer.on("resize",(function(){t.renderer.resize(),t.camera.resize()}))},t.prototype.initTickMechanic=function(){var t=this;this.ticker.on("tick",(function(e){var n=e.getDelta();t.renderer.update(),t.camera.update(),t.playground.update(n)}))},t.prototype.initTouchMechanic=function(){var t,e=this,n=new c.Vector2,i=new c.Vector2,o=function(t){n.x=t.clientX,n.y=t.clientY,e.touched=!0},a=function(o){i.x=o.clientX,i.y=o.clientY;var a=n.distanceTo(i)>5?e.touchedReactDelay:0;clearTimeout(t),t=setTimeout((function(){e.touched=!1}),a)};this.domCanvas.addEventListener("mousedown",o),this.domCanvas.addEventListener("touchstart",o),this.domCanvas.addEventListener("mouseup",a),this.domCanvas.addEventListener("touchend",a),this.domCanvas.addEventListener("mouseleave",a)},t.prototype.setRotationLock=function(t){l=t},t.prototype.getRotationLockStatus=function(){return l},t.prototype.setLoginStatus=function(t){p=t},t.prototype.getLoginStatus=function(){return p},t.prototype.getResources=function(){return i(this,void 0,void 0,(function(){var t;return o(this,(function(e){switch(e.label){case 0:return t=this,[4,(0,u.getResources)()];case 1:return t.resources=e.sent(),[2]}}))}))},t}();e.Base=d},3200:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Camera=void 0;var i=n(691),o=n(2886),a=function(){function t(t){this.base=t,this.bestPoint=new i.Vector3(-8,1,5.6),this.minimunDrawbackAngle=Math.PI/3,this.sizer=this.base.sizer,this.canvas=this.base.domCanvas,this.scene=this.base.scene,this.setInstance(),this.setControls()}return t.prototype.setInstance=function(){var t=new i.PerspectiveCamera(35,this.sizer.width/this.sizer.height,.1,100);t.position.set(this.bestPoint.x,this.bestPoint.y,this.bestPoint.z),this.instance=t,this.scene.add(this.instance)},t.prototype.setControls=function(){this.controls=new o.OrbitControls(this.instance,this.canvas),this.controls.enableDamping=!0,this.controls.enableZoom=!1,this.controls.enablePan=!1},t.prototype.resize=function(){this.instance.aspect=this.sizer.width/this.sizer.height,this.instance.updateProjectionMatrix()},t.prototype.update=function(){this.controls.update()},t}();e.Camera=a},5590:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DomCube=void 0;var i=n(691),o=n(1648),a=n(9702),s=n(6358),r=n(5659),c=n(4799),u=n(475),h=function(){function t(t){this.base=t,this.groupOuter=new i.Group,this.groupInner=new i.Group,this.init()}return t.prototype.init=function(){var t,e;this.chat=new o.Chat(this.base),this.clock=new r.Clock(this.base),this.music=new u.Music(this.base),this.spaceInvader=new a.SpaceInvader(this.base),(t=this.groupInner.scale).set.apply(t,c.cubeLikeConfig.initialScale),(e=this.groupInner.rotation).set.apply(e,c.cubeLikeConfig.initialRotation),this.groupInner.add(this.chat.object),this.groupInner.add(this.clock.object),this.groupInner.add(this.music.object),this.groupInner.add(this.spaceInvader.object),this.groupOuter.add(this.groupInner),this.base.scene2.add(this.groupOuter),this.doAnimation()},t.prototype.doAnimation=function(){s.default.to(this.groupInner.rotation,c.cubeLikeConfig.startAnimationInnerRotationConfig),s.default.to(this.groupInner.scale,c.cubeLikeConfig.startAnimationInnerScalingConfig)},t.prototype.showChat=function(){s.default.to(this.groupInner.rotation,c.cubeLikeConfig.showChatAnimationInnerRotationConfig);var t=(0,c.getTargetAngle)(this.groupOuter.rotation.y);s.default.to(this.groupOuter.rotation,{x:0,y:t,z:0,duration:2})},t.prototype.update=function(t){this.base.touched||this.base.getRotationLockStatus()||(this.groupOuter.rotation.y+=t/c.cubeLikeConfig.updateParameter),this.chat.update(),this.clock.update(),this.music.update(),this.spaceInvader.update()},t}();e.DomCube=h},5755:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Env=void 0;var i=n(691),o=function(){function t(t){this.base=t,this.setLights()}return t.prototype.setLights=function(){this.setAmbientLight(),this.setDirectionalLight(),this.setBackground()},t.prototype.setDirectionalLight=function(){this.directionalLight=new i.DirectionalLight(16777215,1),this.directionalLight.castShadow=!0,this.directionalLight.shadow.mapSize.set(2048,2048),this.directionalLight.shadow.normalBias=.05,this.directionalLight.position.set(3.5,2,-1.25),this.base.scene.add(this.directionalLight)},t.prototype.setAmbientLight=function(){this.ambientLight=new i.AmbientLight(16777215,1),this.base.scene.add(this.ambientLight)},t.prototype.setBackground=function(){this.base.scene.background=this.base.resources.gradientCubeTexture},t.prototype.update=function(t){},t}();e.Env=o},7918:function(t,e,n){var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Playground=void 0;var a=n(5755),s=n(392),r=n(5590),c=function(t){function e(e){var n=t.call(this)||this;return n.base=e,n.ready=!1,n.init(),n}return o(e,t),e.prototype.init=function(){var t=this;this.base.getResources().then((function(){t.env=new a.Env(t.base),t.cube=new s.Cube(t.base),t.domCube=new r.DomCube(t.base),t.ready=!0,t.trigger("ready")}))},e.prototype.update=function(t){this.ready&&(this.env.update(t),this.cube.update(t),this.domCube.update(t))},e}(n(774).EventEmitter);e.Playground=c},6911:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Renderer=void 0;var i=n(691),o=n(1564),a=function(){function t(t){this.base=t,this.sizer=this.base.sizer,this.canvas=this.base.canvas,this.domCanvas=this.base.domCanvas,this.scene=this.base.scene,this.scene2=this.base.scene2,this.camera=this.base.camera,this.setInstances()}return t.prototype.setInstances=function(){this.instance=new i.WebGLRenderer({canvas:this.canvas,antialias:!0}),this.instance.physicallyCorrectLights=!0,this.instance.toneMappingExposure=1.75,this.instance.shadowMap.enabled=!0,this.instance.shadowMap.type=i.PCFSoftShadowMap,this.instance.setClearColor(16777215),this.instance2=new o.CSS3DRenderer({element:this.domCanvas}),this.sizing()},t.prototype.resize=function(){this.sizing()},t.prototype.sizing=function(){this.instance.setSize(this.sizer.width,this.sizer.height),this.instance.setPixelRatio(this.sizer.pixelRatio),this.instance2.setSize(this.sizer.width,this.sizer.height)},t.prototype.update=function(){this.instance.render(this.scene,this.camera.instance),this.instance2.render(this.scene2,this.camera.instance)},t}();e.Renderer=a},17:function(t,e,n){var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Chat=void 0;var a=n(691),s=n(1564),r=n(774),c=n(4799),u=function(t){function e(e){var n=t.call(this)||this;return n.base=e,n.offset=1.7,n.pos=new a.Vector3(0,0,n.offset),n.normal=new a.Vector3(0,0,1),n.cNormal=new a.Vector3,n.cPos=new a.Vector3,n.m4=new a.Matrix4,n.setElement(),n}return o(e,t),e.prototype.setElement=function(){this.element=this.base.domBundle.querySelector("#chat-main-cube"),this.chatMainInner=this.element.querySelector("#chat-main-inner"),this.loginGuide=this.element.querySelector("#login-guide"),this.guestList=this.element.querySelector("#guest-list"),this.loginGuideBtn=this.element.querySelector("#login-guide-button"),this.object=new s.CSS3DObject(this.element),this.object.position.set(0,0,this.offset),this.object.scale.set(1/160,1/160,1),this.bindElementEvents()},e.prototype.showScreen=function(t){var e=this,n="chat-main__inner--hide";this[t].classList.remove(n),["chatMainInner","loginGuide","guestList"].filter((function(e){return e!==t})).forEach((function(t){var i;null===(i=e[t])||void 0===i||i.classList.add(n)}))},e.prototype.refreshGuestList=function(t){var e=this.guestList.querySelector("#guest-list-container");e.innerHTML="";var n="";t.forEach((function(t,e){var i='\n           <li class="guest-list__li guest" style="animation-delay:'.concat(200*e,'ms">\n                <div class="guest__name">').concat(t.username,"</div>\n            </li>\n            ");n+=i})),e.innerHTML=n},e.prototype.bindElementEvents=function(){var t=this;this.loginGuideBtn.addEventListener("pointerdown",(function(){t.trigger("cube-login-button-click")}))},e.prototype.setGuestNumber=function(t){this.guestList.querySelector("#guest-number").innerHTML="NOW ONLINE: ".concat(t)},e.prototype.update=function(){(0,c.updateOcclude)(this)},e}(r.EventEmitter);e.Chat=u},5659:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Clock=void 0;var i=n(691),o=n(1564),a=n(4799),s=function(){function t(t){this.base=t,this.offset=1.7,this.pos=new i.Vector3(-this.offset,0,0),this.normal=new i.Vector3(-1,0,0),this.cNormal=new i.Vector3,this.cPos=new i.Vector3,this.m4=new i.Matrix4,this.setElement()}return t.prototype.setElement=function(){this.element=this.base.domBundle.querySelector("#clock"),this.object=new o.CSS3DObject(this.element),this.object.position.set(-this.offset,0,0),this.object.rotation.y=-Math.PI/2,this.object.scale.set(1/160,1/160,1),this.initClock()},t.prototype.updateClock=function(){for(var t=new Date,e=t.getSeconds(),n=t.getMinutes(),i=t.getHours(),o=t.getMonth(),s=t.getDate(),r=t.getFullYear(),c=["mon","d","y","h","m","s"],u=[["January","February","March","April","May","June","July","August","September","October","November","December"][o],s,r,(0,a.pad)(i,2),(0,a.pad)(n,2),(0,a.pad)(e,2)],h=0;h<c.length;h++)this.element.querySelector("#".concat(c[h])).innerHTML=u[h].toString()},t.prototype.initClock=function(){this.updateClock(),this.timer=setInterval(this.updateClock.bind(this),1e3)},t.prototype.update=function(){(0,a.updateOcclude)(this)},t}();e.Clock=s},1648:function(t,e,n){var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(17),e)},4799:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getTargetAngle=e.createElementFromHTML=e.cubeLikeConfig=e.pad=e.updateOcclude=void 0,e.updateOcclude=function(t){var e=t.base.playground.cube.mesh;t.cNormal.copy(t.normal).applyMatrix3(e.normalMatrix),t.cPos.copy(t.pos).applyMatrix4(t.m4.multiplyMatrices(t.base.camera.instance.matrixWorldInverse,e.matrixWorld));var n=t.cPos.negate().dot(t.cNormal);t.element.style.visibility=n<0?"hidden":"visible"},e.pad=function(t,e){for(var n=t.toString();n.length<e;n=0+n);return n},e.cubeLikeConfig={initialScale:[0,0,0],initialRotation:[Math.PI/3,-Math.PI/3,Math.PI/3],startAnimationInnerRotationConfig:{x:0,y:Math.PI/4,z:0,duration:2},startAnimationInnerScalingConfig:{x:1,y:1,z:1,duration:2},showChatAnimationInnerRotationConfig:{x:0,y:-Math.PI/4,z:0,duration:2},showChatAnimationOuterRotationConfig:{x:0,y:0,z:0,duration:2},updateParameter:5},e.createElementFromHTML=function(t){var e=document.createElement("div");return e.innerHTML=t.trim(),e.firstChild},e.getTargetAngle=function(t){var e=t%(2*Math.PI),n=t-e-.25*Math.PI,i=t+(3*Math.PI/4-e);return e<Math.PI?n:i}},475:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Music=void 0;var i=n(691),o=n(1564),a=n(4799),s=function(){function t(t){this.base=t,this.offset=1.7,this.pos=new i.Vector3(this.offset,0,0),this.normal=new i.Vector3(1,0,0),this.cNormal=new i.Vector3,this.cPos=new i.Vector3,this.m4=new i.Matrix4,this.setElement()}return t.prototype.setElement=function(){this.element=this.base.domBundle.querySelector("#music"),this.object=new o.CSS3DObject(this.element),this.object.position.set(this.offset,0,0),this.object.rotation.y=Math.PI/2,this.object.scale.set(1/160,1/160,1)},t.prototype.update=function(){(0,a.updateOcclude)(this)},t}();e.Music=s},9702:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SpaceInvader=void 0;var i=n(691),o=n(1564),a=n(4799),s=function(){function t(t){this.base=t,this.offset=1.7,this.pos=new i.Vector3(0,0,-this.offset),this.normal=new i.Vector3(0,0,-1),this.cNormal=new i.Vector3,this.cPos=new i.Vector3,this.m4=new i.Matrix4,this.setElement()}return t.prototype.setElement=function(){this.element=this.base.domBundle.querySelector("#space-invader"),this.object=new o.CSS3DObject(this.element),this.object.position.set(0,0,-this.offset),this.object.rotation.y=-Math.PI,this.object.scale.set(1/160,1/160,1)},t.prototype.update=function(){(0,a.updateOcclude)(this)},t}();e.SpaceInvader=s},2367:function(t,e,n){var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var a,s,r,c=n(9735),u=n(3859),h=n(6486),l=n(4799),p=function(t){function e(e,n,i){var o=t.call(this,e,n,i)||this;return o.wrapper=document.querySelector("#wrapper"),o.chatBlock=document.querySelector("#chat-block"),o.rotationLock=o.chatBlock.querySelector("#rotation-lock"),o.chatBlockActive=!1,o.path="https://3d-cube-chat.fly.dev",o.initChatUI(),o}return o(e,t),e.prototype.toggleRotationLockFromUI=function(){var t=this.getRotationLockStatus();t?this.rotationLock.classList.remove("chat-block__rotation-lock--active"):this.rotationLock.classList.add("chat-block__rotation-lock--active"),this.setRotationLock(!t)},e.prototype.setRotationLockFromUI=function(t){t?this.rotationLock.classList.add("chat-block__rotation-lock--active"):this.rotationLock.classList.remove("chat-block__rotation-lock--active"),this.setRotationLock(t)},e.prototype.initChatUI=function(){var t=this,e=this.chatBlock.querySelector("#chat-block-toggler"),n=this.chatBlock.querySelector("#login-button"),i=this.chatBlock.querySelector("#send-message-button"),o=this.chatBlock.querySelector("#logout-button");e.addEventListener("click",(function(){var e;t.chatBlockActive?(t.wrapper.classList.remove("wrapper--active"),e=t.getLoginStatus()?"chatMainInner":"loginGuide",t.setRotationLockFromUI(!1)):(t.wrapper.classList.add("wrapper--active"),e=t.getLoginStatus()?"guestList":"loginGuide"),t.playground.domCube.chat.showScreen(e),t.chatBlockActive=!t.chatBlockActive})),this.playground.on("ready",(function(){t.playground.domCube.chat.showScreen("loginGuide"),t.playground.domCube.chat.on("cube-login-button-click",(function(){var e,n;t.setRotationLockFromUI(!0),1==(e=!0)?(t.wrapper.classList.add("wrapper--active"),n=t.getLoginStatus()?"guestList":"loginGuide"):(t.wrapper.classList.remove("wrapper--active"),n=t.getLoginStatus()?"chatMainInner":"loginGuide",t.setRotationLockFromUI(!1)),t.playground.domCube.chat.showScreen(n),t.chatBlockActive=e}))})),this.rotationLock.addEventListener("click",this.toggleRotationLockFromUI.bind(this)),n.addEventListener("click",(function(){t.myName=(0,h.trim)(t.chatBlock.querySelector("#login-name").value),t.myName?(t.socket=(0,u.io)(t.path),t.initChatSocket(),t.socket.emit("login",{username:t.myName})):alert("Please enter a name :)")})),i.addEventListener("click",(function(){t.sendMessage()})),o.addEventListener("click",(function(){confirm("Are you sure you want to leave?")&&t.socket.emit("logout",{username:t.myName})})),document.addEventListener("keydown",(function(e){13==e.keyCode&&t.sendMessage()}))},e.prototype.initChatSocket=function(){var t=this;this.socket.on("loginSuccess",(function(e){e.username===t.myName?t.checkIn(e):alert("Wrong username:( Please try again!")})),this.socket.on("loginFail",(function(){alert("Duplicate name already exists:0")})),this.socket.on("add",(function(e){"<p>".concat(e.username," 加入聊天室</p>");t.playground.domCube.chat.setGuestNumber(e.userCount),t.playground.domCube.chat.refreshGuestList(null==e?void 0:e.users)})),this.socket.on("leaveSuccess",(function(){t.checkOut()})),this.socket.on("leave",(function(e){if(null!=e.username){t.playground.domCube.chat.refreshGuestList(null==e?void 0:e.users);"<p>".concat(e.username," 退出聊天室</p>");t.playground.domCube.chat.setGuestNumber(e.userCount)}})),this.socket.on("receiveMessage",(function(e){t.showMessage(e)}))},e.prototype.checkIn=function(t){var e=this.chatBlock.querySelector("#login");this.chatBlock.querySelector("#my-name").innerHTML=t.username,e.classList.add("login--logined"),this.setRotationLockFromUI(!0),this.playground.cube.showChat(),this.playground.domCube.showChat(),this.playground.domCube.chat.showScreen("guestList"),this.setLoginStatus(!0)},e.prototype.checkOut=function(){this.chatBlock.querySelector("#login").classList.remove("login--logined"),this.playground.domCube.chat.showScreen("loginGuide"),this.chatBlock.querySelector("#chat-main").innerHTML="",this.setLoginStatus(!1)},e.prototype.sendMessage=function(){var t=this.chatBlock.querySelector("#message-input"),e=t.value;t.value="",e&&this.socket.emit("sendMessage",{username:this.myName,message:e})},e.prototype.showMessage=function(t){var e;e=t.username===this.myName?'<div class="chat-main__chat ">\n                        <div class="chat-main__bubble-name">You</div>\n                        <div class="chat-main__bubble">'.concat(t.message,"</div>\n                    </div>\n                    "):'<div class="chat-main__chat chat-main__chat--other">\n                        <div class="chat-main__bubble-name">'.concat(t.username,'</div>\n                        <div class="chat-main__bubble">').concat(t.message,"</div>\n                    </div>\n                    ");var n=(0,l.createElementFromHTML)(e),i=this.chatBlock.querySelector("#chat-main"),o=this.wrapper.querySelector("#chat-main-cube .chat-main__inner#chat-main-inner");i.appendChild(n),o.appendChild(n.cloneNode(!0)),i.parentElement.scrollTop=i.scrollHeight,o.scrollTop=o.scrollHeight},e}(c.Base);a=document.querySelector("#canvas"),s=document.querySelector("#dom-canvas"),r=document.querySelector("#dom-bundle"),new p(a,s,r)},6076:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Cube=void 0;var i=n(6358),o=n(691),a=n(4799),s=function(){function t(t){this.base=t,this.setModel()}return t.prototype.createRoundedBoxGeo=function(t,e,n,i,a){var s=new o.Shape,r=1e-5,c=i-r,u=.25;s.absarc(r,r,u,-Math.PI/2,-Math.PI,!0),s.absarc(r,e-2*c,u,Math.PI,Math.PI/2,!0),s.absarc(t-2*c,e-2*c,u,Math.PI/2,0,!0),s.absarc(t-2*c,r,u,0,-Math.PI/2,!0);var h=new o.ExtrudeGeometry(s,{depth:n-i,bevelEnabled:!0,bevelSegments:2*a,steps:1,bevelSize:c,bevelThickness:i,curveSegments:a});return h.center(),h},t.prototype.setModel=function(){var t,e,n=this.createRoundedBoxGeo(3,3,3,.4,20),i=new o.MeshMatcapMaterial({matcap:this.base.resources.cubeMatcap});this.group=new o.Group,this.mesh=new o.Mesh(n,i),(t=this.mesh.scale).set.apply(t,a.cubeLikeConfig.initialScale),(e=this.mesh.rotation).set.apply(e,a.cubeLikeConfig.initialRotation),this.group.add(this.mesh),this.base.scene.add(this.group),this.doAnimation()},t.prototype.doAnimation=function(){i.default.to(this.mesh.rotation,a.cubeLikeConfig.startAnimationInnerRotationConfig),i.default.to(this.mesh.scale,a.cubeLikeConfig.startAnimationInnerScalingConfig)},t.prototype.showChat=function(){i.default.to(this.mesh.rotation,a.cubeLikeConfig.showChatAnimationInnerRotationConfig);var t=(0,a.getTargetAngle)(this.group.rotation.y);i.default.to(this.group.rotation,{x:0,y:t,z:0,duration:2}),i.default.to(this.base.camera.instance.position,{x:this.base.camera.bestPoint.x,y:this.base.camera.bestPoint.y,z:this.base.camera.bestPoint.z,duration:2})},t.prototype.update=function(t){this.base.touched||this.base.getRotationLockStatus()||(this.group.rotation.y+=t/a.cubeLikeConfig.updateParameter)},t}();e.Cube=s},392:function(t,e,n){var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(6076),e)},5048:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getResources=void 0;var i=n(8394),o=n(691),a=new o.TextureLoader,s=new o.CubeTextureLoader,r=function(t){return new Promise((function(e,n){a.load(t.path,(function(n){e({name:t.name,content:n})}),null,n)}))},c=function(t){return new Promise((function(e,n){s.load(t.paths,(function(n){e({name:t.name,content:n})}),null,(function(t){console.log(t)}))}))};e.getResources=function(){for(var t=[],e=0,n=i.textureSources;e<n.length;e++){var o=n[e];switch(o.type){case"cubeTexture":t.push(c(o));break;case"texture":t.push(r(o))}}return Promise.all(t).then((function(t){var e={};return t.forEach((function(t){e[t.name]=t.content})),e}))}},8394:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.textureSources=void 0,e.textureSources=[{name:"gradientCubeTexture",type:"cubeTexture",paths:["./assets/images/cubemap/gs-gradient/px.png","./assets/images/cubemap/gs-gradient/nx.png","./assets/images/cubemap/gs-gradient/py.png","./assets/images/cubemap/gs-gradient/ny.png","./assets/images/cubemap/gs-gradient/pz.png","./assets/images/cubemap/gs-gradient/nz.png"]},{name:"cubeMatcap",type:"texture",path:"./assets/images/matcap/BlackRough.png"}]},3111:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EventEmitter=void 0;var n=function(){function t(){this.callbacks={},this.callbacks={},this.callbacks.base={}}return t.prototype.on=function(t,e){var n=this;return void 0===t||""===t?(console.warn("wrong names"),!1):void 0===e?(console.warn("wrong callback"),!1):(this.resolveNames(t).forEach((function(t){var i=n.resolveName(t);n.callbacks[i.namespace]instanceof Object||(n.callbacks[i.namespace]={}),n.callbacks[i.namespace][i.value]instanceof Array||(n.callbacks[i.namespace][i.value]=[]),n.callbacks[i.namespace][i.value].push(e)})),this)},t.prototype.off=function(t){var e=this;return void 0===t||""===t?(console.warn("wrong name"),!1):(this.resolveNames(t).forEach((function(t){var n=e.resolveName(t);if("base"!==n.namespace&&""===n.value)delete e.callbacks[n.namespace];else if("base"===n.namespace)for(var i in e.callbacks)e.callbacks[i]instanceof Object&&e.callbacks[i][n.value]instanceof Array&&(delete e.callbacks[i][n.value],0===Object.keys(e.callbacks[i]).length&&delete e.callbacks[i]);else e.callbacks[n.namespace]instanceof Object&&e.callbacks[n.namespace][n.value]instanceof Array&&(delete e.callbacks[n.namespace][n.value],0===Object.keys(e.callbacks[n.namespace]).length&&delete e.callbacks[n.namespace])})),this)},t.prototype.trigger=function(t,e){var n=this;if(void 0===t||""===t)return console.warn("wrong name"),!1;var i=null,o=null,a=e instanceof Array?e:[],s=this.resolveNames(t),r=this.resolveName(s[0]);if("base"===r.namespace)for(var c in this.callbacks)this.callbacks[c]instanceof Object&&this.callbacks[c][r.value]instanceof Array&&this.callbacks[c][r.value].forEach((function(t){o=t.apply(n,a),void 0===i&&(i=o)}));else if(this.callbacks[r.namespace]instanceof Object){if(""===r.value)return console.warn("wrong name"),this;this.callbacks[r.namespace][r.value].forEach((function(t){o=t.apply(n,a),void 0===i&&(i=o)}))}return i},t.prototype.resolveNames=function(t){var e=t;return e=(e=(e=e.replace(/[^a-zA-Z0-9 ,/.]/g,"")).replace(/[,/]+/g," ")).split(" ")},t.prototype.resolveName=function(t){var e={},n=t.split(".");return e.original=t,e.value=n[0],e.namespace="base",n.length>1&&""!==n[1]&&(e.namespace=n[1]),e},t}();e.EventEmitter=n},774:function(t,e,n){var i=this&&this.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),o=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||i(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),o(n(3111),e),o(n(1600),e),o(n(5388),e)},5388:function(t,e,n){var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Sizer=void 0;var a=function(t){function e(e){var n=t.call(this)||this;return n.canvas=e,n.pixelRatio=Math.min(window.devicePixelRatio,2),n.initSizingMechanic(),n}return o(e,t),e.prototype.initSizingMechanic=function(){this.sizing(),window.addEventListener("resize",this.sizing.bind(this))},e.prototype.sizing=function(){var t=this.canvas.parentElement.getBoundingClientRect();this.width=t.width,this.height=t.height,this.trigger("resize",[this.width,this.height])},e}(n(3111).EventEmitter);e.Sizer=a},1600:function(t,e,n){var i,o=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Ticker=void 0;var a=n(3111),s=n(691),r=function(t){function e(){var e=t.call(this)||this;return e.clock=new s.Clock,window.requestAnimationFrame((function(){e.tick()})),e}return o(e,t),e.prototype.tick=function(){var t=this;this.trigger("tick",[this.clock]),window.requestAnimationFrame((function(){t.tick()}))},e}(a.EventEmitter);e.Ticker=r},1163:()=>{},142:()=>{}},n={};function i(t){var o=n[t];if(void 0!==o)return o.exports;var a=n[t]={id:t,loaded:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.loaded=!0,a.exports}i.m=e,t=[],i.O=(e,n,o,a)=>{if(!n){var s=1/0;for(u=0;u<t.length;u++){for(var[n,o,a]=t[u],r=!0,c=0;c<n.length;c++)(!1&a||s>=a)&&Object.keys(i.O).every((t=>i.O[t](n[c])))?n.splice(c--,1):(r=!1,a<s&&(s=a));r&&(t.splice(u--,1),e=o())}return e}a=a||0;for(var u=t.length;u>0&&t[u-1][2]>a;u--)t[u]=t[u-1];t[u]=[n,o,a]},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),(()=>{var t={179:0};i.O.j=e=>0===t[e];var e=(e,n)=>{var o,a,[s,r,c]=n,u=0;for(o in r)i.o(r,o)&&(i.m[o]=r[o]);if(c)var h=c(i);for(e&&e(n);u<s.length;u++)a=s[u],i.o(t,a)&&t[a]&&t[a][0](),t[s[u]]=0;return i.O(h)},n=self.webpackChunkwebpack_playground=self.webpackChunkwebpack_playground||[];n.forEach(e.bind(null,0)),n.push=e.bind(null,n.push.bind(n))})(),i.O(void 0,[736],(()=>i(7310))),i.O(void 0,[736],(()=>i(2367))),i.O(void 0,[736],(()=>i(142)));var o=i.O(void 0,[736],(()=>i(1163)));o=i.O(o)})();
//# sourceMappingURL=main.2dddd3ffb8c03f072ffc.js.map